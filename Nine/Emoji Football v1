<!-- Emoji Football ‚Äî .nine (no || used) -->

<div id="hud">
  <div>‚è± <span id="time">0:00</span></div>
  <div>Score: <span id="homeScore">0</span> - <span id="awayScore">0</span></div>
  <div>Possession: <span id="possession">HOME</span></div>
  <button id="restart">Restart</button>
</div>
<canvas id="field" width="1024" height="576"></canvas>

<style>
  :root { --bg:#0b1020; --ink:#d2e7ff; }
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui}
  #hud{position:fixed;top:18px;left:18px;z-index:10;background:#0f1426cc;border:1px solid #2b3557;border-radius:12px;padding:10px 14px;display:flex;gap:14px;align-items:center}
  #field{display:block;margin:88px auto 0;background:#0b5;border:2px solid #0a3;border-radius:12px}
</style>

<script type="module" nonce="9ether-dev">
  const TILE=64, GRID_W=16, GRID_H=9;
  const G="üü©", L="üü¶", R="üü•", P1="üßç", P2="üßç‚Äç‚ôÇÔ∏è", BALL="üèà";

  const canvas=document.getElementById("field");
  const ctx=canvas.getContext("2d");
  ctx.font="48px monospace";

  let clock=60, tick=null, aiTick=null, ballTick=null;
  let lastDir=[1,0];
  let possession="HOME";
  const score={home:0,away:0};

  function buildField(){
    const rows=[];
    for(let y=0;y<GRID_H;y++){
      if(y===0||y===GRID_H-1){ rows.push(Array(GRID_W).fill(G).join("")); continue; }
      const row=Array(GRID_W).fill(G);
      row[0]=L; row[1]=L; row[GRID_W-1]=R; row[GRID_W-2]=R;
      rows.push(row.join(""));
    }
    return rows;
  }
  let map=buildField();

  const ents={
    home:{x:3,y:Math.floor(GRID_H/2),emoji:P1},
    away:{x:GRID_W-4,y:Math.floor(GRID_H/2),emoji:P2},
    ball:{x:4,y:Math.floor(GRID_H/2),vx:0,vy:0}
  };

  function putEmoji(x,y,e){ ctx.fillText(e,x*TILE,(y+1)*TILE-12); }
  function tileAt(x,y){ if(y<0||y>=GRID_H||x<0||x>=GRID_W) return "#"; return map[y][x]||G; }
  function clamp(v,min,max){ return Math.min(max,Math.max(min,v)); }

  function centerKickoff(serve){
    map=buildField();
    ents.home.x=3; ents.home.y=Math.floor(GRID_H/2);
    ents.away.x=GRID_W-4; ents.away.y=Math.floor(GRID_H/2);
    ents.ball.x = serve==="HOME" ? ents.home.x+1 : ents.away.x-1;
    ents.ball.y = Math.floor(GRID_H/2);
    ents.ball.vx=0; ents.ball.vy=0;
    possession=serve;
  }

  function updateHUD(){
    const mm=String(Math.floor(clock/60)); const ss=String(clock%60).padStart(2,"0");
    document.getElementById("time").textContent=`${mm}:${ss}`;
    document.getElementById("homeScore").textContent=String(score.home);
    document.getElementById("awayScore").textContent=String(score.away);
    document.getElementById("possession").textContent=possession;
  }

  function drawField(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(let y=0;y<GRID_H;y++){
      for(let x=0;x<GRID_W;x++){
        const t=tileAt(x,y);
        ctx.globalAlpha=0.12; ctx.fillStyle=((x+y)%2)?"#fff":"#000";
        ctx.fillRect(x*TILE,y*TILE,TILE,TILE); ctx.globalAlpha=1;
        const glyph = t===L?"üü¶":(t===R?"üü•":"üü©");
        putEmoji(x,y,glyph);
      }
    }
    for(let y=0;y<GRID_H;y++) putEmoji(Math.floor(GRID_W/2),y,"‚¨úÔ∏è");
    putEmoji(ents.home.x,ents.home.y,P1);
    putEmoji(ents.away.x,ents.away.y,P2);
    putEmoji(ents.ball.x,ents.ball.y,BALL);
  }

  function move(dx,dy){
    lastDir=[ dx!==0?dx:lastDir[0], dy!==0?dy:lastDir[1] ];
    const nx=clamp(ents.home.x+dx,0,GRID_W-1);
    const ny=clamp(ents.home.y+dy,0,GRID_H-1);
    ents.home.x=nx; ents.home.y=ny;

    if(ents.home.x===ents.ball.x && ents.home.y===ents.ball.y){ possession="HOME"; }
    if(possession==="HOME"){ ents.ball.x=ents.home.x; ents.ball.y=ents.home.y; }

    checkScore(); drawField();
  }

  function kick(power){
    if(possession!=="HOME") return;
    const dx=lastDir[0], dy=lastDir[1];
    if(dx===0 && dy===0) return;
    possession="LOOSE";
    ents.ball.vx=dx; ents.ball.vy=dy;
    let steps=power;
    if(ballTick){ clearInterval(ballTick); }
    ballTick=setInterval(function(){
      if(steps<=0){ ents.ball.vx=0; ents.ball.vy=0; clearInterval(ballTick); return; }
      steps=steps-1;
      const bx=clamp(ents.ball.x+ents.ball.vx,0,GRID_W-1);
      const by=clamp(ents.ball.y+ents.ball.vy,0,GRID_H-1);
      ents.ball.x=bx; ents.ball.y=by;
      if(ents.away.x===ents.ball.x && ents.away.y===ents.ball.y){ possession="AWAY"; clearInterval(ballTick); }
      checkScore(); drawField();
    },70);
  }

  function aiStep(){
    let tx,ty;
    if(possession==="AWAY"){ tx=GRID_W-2; ty=ents.away.y; }
    else if(possession==="HOME"){ tx=ents.home.x; ty=ents.home.y; }
    else { tx=ents.ball.x; ty=ents.ball.y; }
    const dx=Math.sign(tx-ents.away.x);
    const dy=Math.sign(ty-ents.away.y);
    ents.away.x=clamp(ents.away.x+dx,0,GRID_W-1);
    ents.away.y=clamp(ents.away.y+dy,0,GRID_H-1);
    if(ents.away.x===ents.ball.x && ents.away.y===ents.ball.y){ possession="AWAY"; }
    if(possession==="AWAY"){ ents.ball.x=ents.away.x; ents.ball.y=ents.away.y; }
    checkScore(); drawField();
  }

  function checkScore(){
    const t=tileAt(ents.ball.x,ents.ball.y);
    if(t===R){ score.home=score.home+1; centerKickoff("AWAY"); flash("TOUCHDOWN HOME! üü¢"); }
    else if(t===L){ score.away=score.away+1; centerKickoff("HOME"); flash("TOUCHDOWN AWAY! üî¥"); }
    updateHUD();
  }

  function flash(msg){
    const el=document.createElement('div');
    el.textContent=msg;
    el.style.position='fixed'; el.style.top='50%'; el.style.left='50%';
    el.style.transform='translate(-50%,-50%)'; el.style.padding='18px 22px';
    el.style.background='#0b1a12ee'; el.style.color='#9ff5bb'; el.style.border='1px solid #2e5';
    el.style.borderRadius='12px'; el.style.zIndex='9999';
    document.body.appendChild(el); setTimeout(function(){ el.remove(); },1200);
  }

  document.addEventListener('keydown', function(e){
    if(["ArrowUp","w"].includes(e.key)) move(0,-1);
    else if(["ArrowDown","s"].includes(e.key)) move(0,1);
    else if(["ArrowLeft","a"].includes(e.key)) move(-1,0);
    else if(["ArrowRight","d"].includes(e.key)) move(1,0);
    else if(e.key===" ") kick(4);
  });
  document.getElementById('restart').onclick=function(){ boot(); };

  function boot(){
    if(tick) clearInterval(tick); if(aiTick) clearInterval(aiTick); if(ballTick) clearInterval(ballTick);
    score.home=0; score.away=0; clock=60; centerKickoff("HOME");
    tick=setInterval(function(){ if(clock<=0){ clearInterval(tick); clearInterval(aiTick); flash("‚è± Game Over"); } else { clock=clock-1; updateHUD(); } },1000);
    aiTick=setInterval(aiStep,140);
    updateHUD(); drawField();
  }
  boot();
</script>
